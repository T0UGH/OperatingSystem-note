### 13.4 IO内核子系统
---
- 内核IO子系统提供许多服务
    - 调度
    - 缓冲
    - 高速缓存
    - 假脱机
    - 设备预留与错误处理

- 内核IO子系统建立在硬件和设备驱动程序结构之上
---
#### 13.4.1 IO调度
- 调度一组IO请求就是确定一个合适的顺序来执行这些请求

- 操作系统通过给每个设备维护一个请求队列来实现请求
    - 当一个应用程序执行阻塞IO系统调用时，该请求就加到相应设备的队列上
    - IO调度重新安排队列顺序改善系统总体效率和应用程序的平均响应时间
---
#### 13.4.2 缓冲
- 缓冲区：用来保存两个设备之间或在设备与应用之间所传输数据的内存区域

- 采用缓冲区的理由
    1. 处理数据流的生产者与消费者之间的速度差异
    2. 协调传输数据大小不一致的设备
        - 例如网络传输中的分包与重组
    3. 支持应用程序IO的复制语义
        - 复制语义:写入磁盘的数据就是`write()`系统调用发生时的版本
---
#### 13.4.3 高速缓存

- 高速缓存：是可以保留数据副本的高速存储器

- 高速缓冲区副本的访问要比原始数据访问更为高效
---
#### 13.4.4 假脱机与设备预留

- 假脱机用于保存设备输出的缓冲区

- 例如：一个打印机只能同时打印几个文件，如果一个时间有多个文件到达，则维护一个缓冲队列，让其他文件等待
---
#### 13.4.5 错误处理

- 采用内存保护的操作系统可以预防许多硬件和应用程序的错误

- IO系统调用通常返回一个位来表示调用状态信息，以表示成功或失败
---
#### 13.4.6 IO保护

- 为了防止用户执行非法IO，定义所有IO指令为特权指令

- 用户不能直接发出IO指令，必须通过操作系统来进行

- 所有的内存映射和IO端口内存位置都受到内存保护系统的保护，以阻止用户访问
---
Copyleft ! 2018 T0UGH. All rights reserved under the MIT license.